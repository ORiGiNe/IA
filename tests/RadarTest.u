requireFile("../core/Radar.u");

echo("Start");
//var g = UGaop.new("/dev/ttyUSB1");
//var s = UCapteur.new(4,g);
//g.initialise;

var s = Object.new|;
function s.get
{
    return 30
}|;

var opponent = Event.new|;

var r = Radar.new([s],["N"],opponent)|;
r.posMonitored = ["N"]|;
r.delay = 1s|;
r.monitor,

var state = "normal"|;
//every (0.2s) {
//	echo(s.get)
//},

at (opponent?)
    echo ("OPPONENT ???");

whenever (opponent? ~ 2s)
	if (state != "crisis")
	{
		state = "crisis";
		echo("OPPONENT !!!");

		l: every (1s) {
			echo("working")
		},

		sleep(2);
		l.stop;
        echo ("work done");
		state = "crisi"
	};

sleep(5s);
s.get = function {
    return 4
}|;

sleep(10s);
s.get = function {
    return 40
}|;

sleep(4s);
s.get = function {
    return 4
}|;

sleep(1);
s.get = function {
    return 35
}|;
